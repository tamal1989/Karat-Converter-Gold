<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Karat Gold Converter</title>
<style>
  :root{
    --bg:#f7f7f8;
    --card:#ffffff;
    --muted:#6b7280;
    --accent:#caa24a;
    --accent-dark:#b08934;
    --text:#0f172a;
    --glass: rgba(255,255,255,0.6);
    font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    background:
      linear-gradient(180deg, rgba(202,162,74,0.06) 0%, rgba(250,250,250,0.02) 60%),
      var(--bg);
    color:var(--text);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    padding:32px;
    display:flex;
    justify-content:center;
  }

  .wrap{
    width:100%;
    max-width:980px;
  }

  header{
    display:flex;
    gap:16px;
    align-items:flex-start;
    margin-bottom:22px;
  }
  .logo{
    background:var(--accent);
    color:#fff;
    font-weight:700;
    padding:10px 14px;
    border-radius:12px;
    box-shadow:0 6px 18px rgba(160,120,40,0.12);
    font-size:18px;
  }
  h1{
    margin:0;
    font-size:28px;
    letter-spacing:0.4px;
  }
  p.lead{
    margin:8px 0 0 0;
    color:var(--muted);
    font-size:14px;
    line-height:1.45;
  }

  .card{
    background:linear-gradient(180deg, rgba(255,255,255,0.9), var(--card));
    border-radius:14px;
    padding:22px;
    box-shadow:0 10px 30px rgba(12,15,25,0.06);
    display:grid;
    gap:18px;
  }

  .controls{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:12px;
  }

  .row{
    display:flex;
    gap:12px;
    align-items:center;
  }

  label{
    display:block;
    font-size:13px;
    color:var(--muted);
    margin-bottom:6px;
  }

  input[type="number"], select{
    width:100%;
    padding:12px 14px;
    border-radius:12px;
    border:1px solid rgba(15,23,42,0.06);
    background:transparent;
    font-size:15px;
  }

  .unit-select{
    width:150px;
    min-width:120px;
  }

  .big{
    grid-column: 1 / -1;
    display:flex;
    gap:12px;
    flex-wrap:wrap;
    align-items:center;
  }

  button.primary{
    background:linear-gradient(180deg,var(--accent),var(--accent-dark));
    color:#fff;
    border:0;
    padding:12px 18px;
    border-radius:999px;
    font-weight:700;
    cursor:pointer;
    box-shadow:0 8px 18px rgba(176,136,56,0.14);
  }

  .results{
    background:linear-gradient(180deg, rgba(250,250,250,0.6), rgba(255,255,255,0.85));
    border-radius:12px;
    padding:18px;
    border:1px solid rgba(11,12,16,0.03);
  }

  .result-title{
    font-weight:700;
    margin:0 0 6px 0;
  }
  .result-sub{
    color:var(--muted);
    font-size:14px;
    margin:0 0 12px 0;
  }

  .detail{
    background:linear-gradient(180deg,#fff,#fbfbfb);
    border-radius:10px;
    padding:12px;
    margin-bottom:10px;
    border:1px solid rgba(11,12,16,0.03);
  }

  .kpi{
    display:flex;
    gap:16px;
    flex-wrap:wrap;
  }
  .kpi .item{
    min-width:170px;
    flex:1;
    background:rgba(250,250,250,0.6);
    border-radius:10px;
    padding:10px;
  }
  .kpi .title{font-size:13px;color:var(--muted);margin-bottom:6px}
  .kpi .value{font-weight:700;font-size:16px}

  pre.formula{
    background:#0b122022;
    padding:10px;
    border-radius:8px;
    color:#051018;
    font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, 'Courier New', monospace;
    font-size:13px;
    overflow:auto;
  }

  .note{
    color:var(--muted);
    font-size:13px;
  }

  footer{
    margin-top:16px;
    display:flex;
    justify-content:space-between;
    gap:12px;
    align-items:center;
    flex-wrap:wrap;
  }

  .small-btn{
    background:transparent;
    border:1px solid rgba(15,23,42,0.06);
    padding:8px 12px;
    border-radius:999px;
    cursor:pointer;
  }

  /* responsive */
  @media (max-width:720px){
    header{align-items:center}
    .controls{grid-template-columns: 1fr;}
    .unit-select{width:100%}
    .kpi .item{min-width:140px}
  }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">GOLD KARAT</div>
      <div>
        <h1>Karat Gold Converter</h1>
        <p class="lead">Convert between karats (8K → 24K). Get step-by-step results: how much pure gold, how much alloy to add (or how much pure gold to add) and final totals in grams or ounces.</p>
      </div>
    </header>

    <div class="card" role="main" aria-labelledby="main-title">
      <div class="controls">
        <div>
          <label for="amount">Amount</label>
          <input id="amount" type="number" step="0.01" min="0" value="1" />
        </div>

        <div>
          <label for="unit">Unit</label>
          <select id="unit" class="unit-select">
            <option value="g">Gram(s)</option>
            <option value="oz">Ounce(s) (troy)</option>
          </select>
        </div>

        <div>
          <label for="sourceK">Source Karat</label>
          <select id="sourceK">
            <option>24</option>
            <option>22</option>
            <option>20</option>
            <option>18</option>
            <option>16</option>
            <option>14</option>
            <option>10</option>
            <option>9</option>
            <option>8</option>
          </select>
        </div>

        <div>
          <label for="targetK">Target Karat</label>
          <select id="targetK">
            <option>24</option>
            <option>22</option>
            <option>20</option>
            <option selected>10</option>
            <option>9</option>
            <option>8</option>
            <option>14</option>
            <option>16</option>
            <option>18</option>
          </select>
        </div>

        <div class="big">
          <button class="primary" id="calcBtn">CALCULATE</button>
          <button class="small-btn" id="resetBtn">RESET</button>
          <div style="margin-left:auto" class="note">Tip: If you have 24K pure gold and want to make lower karat, enter source=24.</div>
        </div>
      </div>

      <div class="results" id="results" aria-live="polite">
        <p class="result-title" id="resTitle">No calculation yet</p>
        <p class="result-sub" id="resSub">Enter an amount and choose source &amp; target karat, then press Calculate.</p>

        <div id="details" style="display:none">
          <div class="detail">
            <div class="kpi">
              <div class="item">
                <div class="title">Starting weight</div>
                <div class="value" id="kp-start">—</div>
              </div>

              <div class="item">
                <div class="title">Pure gold in start</div>
                <div class="value" id="kp-gold">—</div>
              </div>

              <div class="item">
                <div class="title">Target karat fraction</div>
                <div class="value" id="kp-target">—</div>
              </div>

              <div class="item">
                <div class="title">Final total weight</div>
                <div class="value" id="kp-final">—</div>
              </div>
            </div>

            <hr style="border:none;margin:12px 0;border-top:1px solid #eee" />

            <div id="scenarioText" style="margin-bottom:10px"></div>

            <div>
              <div class="title" style="font-size:13px;margin-bottom:6px">Formula(s) used</div>
              <pre class="formula" id="formulaArea"></pre>
            </div>
          </div>

          <div class="note" id="extraNote"></div>
        </div>

      </div>

      <footer>
        <div class="note">Supports karats: 8K, 9K, 10K, 14K, 16K, 18K, 20K, 22K, 24K. Values shown with 3 decimal places (configurable in script).</div>
        <div style="font-size:13px;color:var(--muted)">Made for responsive web and mobile devices</div>
      </footer>
    </div>
  </div>

<script>
(function(){
  const el = (id)=>document.getElementById(id);
  const amt = el('amount');
  const unit = el('unit');
  const src = el('sourceK');
  const tgt = el('targetK');
  const calcBtn = el('calcBtn');
  const resetBtn = el('resetBtn');

  const resTitle = el('resTitle');
  const resSub = el('resSub');
  const details = el('details');
  const kpStart = el('kp-start');
  const kpGold = el('kp-gold');
  const kpTarget = el('kp-target');
  const kpFinal = el('kp-final');
  const scenarioText = el('scenarioText');
  const formulaArea = el('formulaArea');
  const extraNote = el('extraNote');

  const PREC = 3; // decimal places

  function fmt(n){
    return (Math.round(n * Math.pow(10,PREC))/Math.pow(10,PREC)).toFixed(PREC);
  }

  function toGrams(value, u){
    if(u === 'g') return value;
    // troy ounce -> grams (1 troy oz = 31.1034768 g)
    return value * 31.1034768;
  }
  function fromGrams(g, u){
    if(u === 'g') return g;
    return g / 31.1034768;
  }

  function calculate(){
    const amountVal = parseFloat(amt.value);
    if(isNaN(amountVal) || amountVal <= 0){
      alert('Please enter a valid amount greater than zero.');
      return;
    }
    const unitVal = unit.value;
    const srcK = parseInt(src.value,10);
    const tgtK = parseInt(tgt.value,10);

    if(srcK === tgtK){
      resTitle.textContent = `Source and target are both ${srcK}K — no change needed.`;
      resSub.textContent = `You already have ${fmt(amountVal)} ${unitVal} of ${srcK}K.`;
      details.style.display = 'none';
      return;
    }

    // work in grams
    const startGrams = toGrams(amountVal, unitVal);
    const srcFrac = srcK / 24;
    const tgtFrac = tgtK / 24;

    // pure gold mass in starting item
    const goldMass = startGrams * srcFrac;
    // if source is 24K special simple case: starting goldMass == startGrams
    // Option 1: Make target by adding alloy only (no extra gold) => finalTotal = goldMass / tgtFrac
    const finalTotalIfAddAlloy = goldMass / tgtFrac; // grams
    const alloyToAddIfOnlyAlloy = finalTotalIfAddAlloy - startGrams; // grams to add (may be negative)

    // Option 2: Add pure gold (no alloy), keep total mass = startGrams + x, gold = goldMass + x so final frac = (goldMass + x)/(startGrams + x) = tgtFrac
    // Solve: (goldMass + x) = tgtFrac * (startGrams + x) => goldMass + x = tgtFrac*startGrams + tgtFrac*x
    // => x - tgtFrac*x = tgtFrac*startGrams - goldMass => x*(1 - tgtFrac) = tgtFrac*startGrams - goldMass
    const numerator = tgtFrac * startGrams - goldMass;
    const denom = 1 - tgtFrac;
    const pureGoldToAddIfNeeded = numerator / denom; // may be negative

    // Compose output text
    let title, subtitle;
    if(srcK === 24){
      // user has pure gold: easiest explanation like screenshot
      title = `To make ${tgtK}K gold:`;
      subtitle = `Mix ${fmt(startGrams)} g of 24K gold and ${fmt(alloyToAddIfOnlyAlloy)} g of alloy mix.\nThe result: ${fmt(finalTotalIfAddAlloy)} g of ${tgtK}K gold.`;
    } else {
      // generalized explanation and offer both options
      title = `${fmt(amountVal)} ${unitVal} of ${srcK}K → target ${tgtK}K`;
      if(alloyToAddIfOnlyAlloy >= 0){
        // possible by adding alloy only (no extra gold needed)
        subtitle = `You can make ${tgtK}K by adding ${fmt(alloyToAddIfOnlyAlloy)} g of alloy (no extra gold required).\nFinal total weight: ${fmt(finalTotalIfAddAlloy)} g.`;
      } else {
        // alloyToAdd negative means starting item is too heavy in alloy (i.e., has less gold than target fraction), so need to add pure gold instead.
        subtitle = `You cannot reach ${tgtK}K by just adding alloy — your starting piece has too little gold for this target. Instead add ${fmt(pureGoldToAddIfNeeded)} g of pure 24K gold to reach ${tgtK}K without removing material.\nFinal total weight: ${fmt(startGrams + pureGoldToAddIfNeeded)} g.`;
      }
    }

    // display
    resTitle.textContent = title;
    resSub.textContent = subtitle;
    details.style.display = 'block';

    kpStart.textContent = `${fmt(startGrams)} g (${fmt(fromGrams(startGrams, unitVal))} ${unitVal})`;
    kpGold.textContent = `${fmt(goldMass)} g pure gold (${fmt(100*srcFrac)}% of start)`;
    kpTarget.textContent = `${fmt(tgtFrac)} (${tgtK}K)`;
    // pick final total depending on best suggestion
    const chosenFinal = (alloyToAddIfOnlyAlloy >= 0) ? finalTotalIfAddAlloy : startGrams + pureGoldToAddIfNeeded;
    kpFinal.textContent = `${fmt(chosenFinal)} g (${fmt(fromGrams(chosenFinal, unitVal))} ${unitVal})`;

    // scenario text detailed
    let scenarioHTML = '';
    scenarioHTML += `<strong>Detailed plan:</strong><br/>`;
    scenarioHTML += `Start: <strong>${fmt(startGrams)} g</strong> of ${srcK}K (contains <strong>${fmt(goldMass)} g</strong> pure gold).<br/>`;

    if(srcK === 24){
      scenarioHTML += `Since you're starting with pure 24K gold, to make ${tgtK}K you must <strong>add alloy</strong> (non-gold) until the gold fraction equals ${fmt(tgtFrac)} (i.e. ${tgtK}K).<br/>`;
      scenarioHTML += `<em>How:</em> total_final = gold_mass / target_fraction = ${fmt(goldMass)} / ${fmt(tgtFrac)} = <strong>${fmt(finalTotalIfAddAlloy)} g</strong>.<br/>Alloy to add = final - starting = ${fmt(finalTotalIfAddAlloy)} - ${fmt(startGrams)} = <strong>${fmt(alloyToAddIfOnlyAlloy)} g</strong>.`;
    } else {
      if(alloyToAddIfOnlyAlloy >= 0){
        scenarioHTML += `You can achieve ${tgtK}K by <strong>adding ${fmt(alloyToAddIfOnlyAlloy)} g of alloy</strong> (no extra pure gold required).<br/>The math: final_total = gold_mass / target_fraction = ${fmt(goldMass)} / ${fmt(tgtFrac)} = <strong>${fmt(finalTotalIfAddAlloy)} g</strong>.<br/>Added alloy = final_total - starting_weight = ${fmt(finalTotalIfAddAlloy)} - ${fmt(startGrams)} = <strong>${fmt(alloyToAddIfOnlyAlloy)} g</strong>.`;
      } else {
        scenarioHTML += `You <strong>cannot</strong> reach ${tgtK}K by adding alloy only because your starting piece has less gold (lower gold fraction) than the target requires.<br/>Option: <strong>add pure 24K gold</strong> of ${fmt(pureGoldToAddIfNeeded)} g.\n`;
        scenarioHTML += `Derivation: solve x from (gold_mass + x)/(start + x) = target_fraction -> x = (target_fraction*start - gold_mass) / (1 - target_fraction) = <strong>${fmt(pureGoldToAddIfNeeded)} g</strong>.<br/>Final total weight = ${fmt(startGrams + pureGoldToAddIfNeeded)} g.`;
      }
    }

    scenarioText.innerHTML = scenarioHTML;

    // formula area show main formulas used
    let f = '';
    f += `Definitions:\n  source_karat_fraction = sourceK / 24\n  target_karat_fraction = targetK / 24\n  gold_mass = starting_weight * source_karat_fraction\n\n`;
    f += `If only adding alloy (no extra gold):\n  final_total = gold_mass / target_karat_fraction\n  alloy_to_add = final_total - starting_weight\n\n`;
    f += `If adding pure 24K gold instead (no removal):\n  Solve for x: (gold_mass + x) / (starting_weight + x) = target_karat_fraction\n  => x = (target_karat_fraction*starting_weight - gold_mass) / (1 - target_karat_fraction)\n\n`;
    f += `Numeric results (grams):\n  starting_weight = ${fmt(startGrams)}\n  gold_mass = ${fmt(goldMass)}\n  target_fraction = ${fmt(tgtFrac)}\n  final_total (if alloy only) = ${fmt(finalTotalIfAddAlloy)}\n  alloy_to_add = ${fmt(alloyToAddIfOnlyAlloy)}\n  pure_gold_to_add = ${fmt(pureGoldToAddIfNeeded)}\n`;
    formulaArea.textContent = f;

    // extra note
    let note = '';
    if(alloyToAddIfOnlyAlloy >= 0){
      note = `✓ This plan uses only alloy addition (no extra gold). If you prefer, you can instead add small quantities of pure gold and adjust accordingly.`;
    } else {
      note = `⚠ You need to add pure gold to reach the target karat. Alternatively, you could remove alloy (reduce total weight) until the fraction matches, but that requires physically removing metal.`;
    }
    extraNote.textContent = note;
  }

  calcBtn.addEventListener('click', calculate);
  resetBtn.addEventListener('click', function(){
    amt.value = '1'; unit.value='g'; src.value='24'; tgt.value='10';
    resTitle.textContent = 'No calculation yet';
    resSub.textContent = 'Enter an amount and choose source & target karat, then press Calculate.';
    details.style.display = 'none';
    formulaArea.textContent = '';
    extraNote.textContent = '';
  });

  // initial sample calc
  calculate();
})();
</script>
</body>
</html>
